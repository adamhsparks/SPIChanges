
# SPIChanges

<!-- badges: start -->
<!-- badges: end -->

A package designed to improve the interpretation of the Standardized
Precipitation index under changing climate conditions.

# Basic Description

The package improves the interpretation of the Standardized
Precipitation Index (SPI) under changing climate conditions. It is based
on the non-stationary parametric approach proposed in Blain et
al. (2022). This latter study developed a four-step algorithm able to
detect trends in rainfall patterns and to quantify the effect of such
trends on the probability of a SPI value occurring.

## Installation

You can install the development version of SPIChanges from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("gabrielblain/SPIChanges")
```

## Theoretical Background

The Standard Precipitation Index (SPI) was originally designed as a
stationary index, where the parameters of the distribution used to
estimate the cumulative probability of rainfall quantities (often the
two-parameter gamma distribution) do not vary over time. However, due to
the alteration of rainfall patterns worldwide from climate change, using
non-stationary distributions to calculate a non-stationary version of
this drought index (NSPI) has become an important step to adjust for
possible changing rainfall patterns (Park et al., 2019). Previous
studies, however, have shown that interpreting NSPI estimates is not
straightforward, as time-varying parametric distributions remove the
effect of rainfall trends on the NSPI (Shiau, 2020). Consequently, in
the presence of decreasing (or increasing) rainfall trends, the NSPI may
underestimate (or overestimate) drought occurrence (Park et al., 2019;
Shiau, 2020).

This package, based on the study by Blain et al. (2022), demonstrates
that the challenge of interpreting SPI estimates under changing climatic
conditions can be overcome by using information generated by the NSPI
calculation algorithm. This algorithm uses non-stationary distributions
to detect trends and quantify their effect on the occurrence of specific
SPI values. In other words, the `ChangeSPI` package leverages the
non-stationary approach of the NSPI algorithm to detect trends in
rainfall series and enhance the understanding of how changes in rainfall
variability affect the expected frequency of specific SPI values. With
this background, the key function of this package is `ChangeSPI()`,
which is based on the following steps:

1.  Given a rainfall series with data accumulated at a particular time
    scale, the package uses the stationary version of the two-parameter
    gamma distribution to calculate SPI estimates and the cumulative
    probability of each rainfall amount occurring (i.e., the probability
    of each SPI estimate occurring).

2.  Using the second-order Akaike Information Criterion (AICc), the
    package selects the best-fitting model among distinct nonstationary
    two-parameter gamma distributions (see details).

3.  The package uses the selected nonstationary model to calculate the
    cumulative probability of each rainfall amount occurring under
    changing climate conditions.

4.  The package compares the probabilities estimated in steps 1 and 3.
    This comparison may indicate whether the frequency of a particular
    drought event, quantified by the SPI, has increased or decreased
    over time.

## Example 1

Aggregating daily rainfall values at 4-quasiWeek time scale, which
corresponds to monthly data.

``` r
library(SPIChanges)
daily.rain <- CampinasRain[,2]
rainTS4 <- TSaggreg(daily.rain=daily.rain,start.date="1991-01-01",TS=4)
```

    ## Done. Just ensure the last quasi-week is complete.
    ##   The last day of your series is 31 and TS is 4

``` r
View(rainTS4)
```

## Example 2

Using only linear non-stationary parametric models to assess the
probability of rainfall amounts. The models are based on the
two-parameter gamma distribution with parameters estimated by the
maximum likelihood method. The packages `gamlss` and `gamlss.dist` are
used for such estimations.

``` r
#
library(SPIChanges)
daily.rain <- CampinasRain[,2]
rainTS4 <- TSaggreg(daily.rain=daily.rain,start.date="1991-01-01",TS=4)
```

    ## Done. Just ensure the last quasi-week is complete.
    ##   The last day of your series is 31 and TS is 4

``` r
Changes.in.the.SPI <- SPIChanges(rain.at.TS=rainTS4, only.linear = "Yes")
View(Changes.in.the.SPI$data.week)
View(Changes.in.the.SPI$data.week)
View(Changes.in.the.SPI$model.selection)
View(Changes.in.the.SPI$Changes.Freq.Drought)
```

## Example 3

Using linear and non-linear non-stationary parametric models to assess
the probability of rainfall amounts. The models are based on the
two-parameter gamma distribution with parameters estimated by the
maximum likelihood method. The packages `gamlss` and `gamlss.dist` are
used for such estimations.

``` r
#
library(SPIChanges)
daily.rain <- CampinasRain[,2]
rainTS4 <- TSaggreg(daily.rain=daily.rain,start.date="1991-01-01",TS=4)
```

    ## Done. Just ensure the last quasi-week is complete.
    ##   The last day of your series is 31 and TS is 4

``` r
Changes.in.the.SPI <- SPIChanges(rain.at.TS=rainTS4, only.linear = "No")
View(Changes.in.the.SPI$data.week)
View(Changes.in.the.SPI$data.week)
View(Changes.in.the.SPI$model.selection)
View(Changes.in.the.SPI$Changes.Freq.Drought)
```

## BugReports:

\<<https://github.com/gabrielblain/SPIChanges/issues> \>

## License:

MIT

## Authors:

Gabriel Constantino Blain, Graciela da Rocha Sobierajski. Maintainer:
Gabriel Constantino Blain, <gabriel.blain@sp.gov.br>

## Acknowledgments:

The package uses data from the Agronomic Institute of Campinas. The
authors greatly appreciate this initiative.

## References

Blain G C, Sobierajski G R, Weight E, Martins L L, Xavier A C F 2022.
Improving the interpretation of standardized precipitation index
estimates to capture drought characteristics in changing climate
conditions. International Journal of Climatology, 42, 5586-5608.
<https://doi.org/10.1002/joc.7550>

Package ‘gamlss’, Version 5.4-22, Author Stasinopoulos Mikis et al.,
<https://CRAN.R-project.org/package=gamlss>

Package ‘gamlss.dist’, Version 6.1-1, Author Stasinopoulos Mikis et al.,
<https://CRAN.R-project.org/package=gamlss.dist>

Park, J., Sung, J.H., Lim, Y-J, Kang, H-S. 2019. Introduction and
application of non-stationary standardized precipitation index
considering probability distribution function and return period.
Theoretical and Applied Climatology, 136:529-542.
<https://doi.org/10.1007/s00704-018-2500-y>

Shiau, J-T. 2020. Effects of Gamma-Distribution Variations on SPI-Based
Stationary and Nonstationary Drought Analyses. Water Resources
Management, 34:2081-2095. <https://doi.org/10.1007/s11269-020-02548-x>
